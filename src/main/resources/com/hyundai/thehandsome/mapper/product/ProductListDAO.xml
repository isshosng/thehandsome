<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
		
<mapper namespace="com.hyundai.thehandsome.mapper.product.ProductListDAO">
	<select id="getPListWithCategory"
		resultType="com.hyundai.thehandsome.Vo.product.CatePListVO">
		SELECT DISTINCT
		brand.bname, pcommon.pname, pcolor.pcprice, pcommon.pid
		FROM product_common pcommon

		INNER JOIN product_color pcolor
		ON pcommon.pid = pcolor.pid

		INNER JOIN brand brand
		ON brand.bno = pcommon.bno

		INNER JOIN pid_with_category_view v
		ON v.pid = pcommon.pid
		<if
			test="!@com.hyundai.thehandsome.test.MybatisCheckNull@isEmpty(depth1name)">
			where v.depth1name = #{depth1name}
		</if>
		<if
			test="!@com.hyundai.thehandsome.test.MybatisCheckNull@isEmpty(depth2name)">
			and v.depth2name = #{depth2name}
		</if>
		<if
			test="!@com.hyundai.thehandsome.test.MybatisCheckNull@isEmpty(depth3name)">
			and v.depth3name = #{depth3name}
		</if>
	</select>

	<select id="getPListWithLikes"
		resultType="com.hyundai.thehandsome.Vo.product.CatePListVO">
		SELECT DISTINCT
		brand.bname,
		pcommon.pname,
		pcolor.pcprice,
		pcommon.pid
		FROM
		product_common pcommon
		INNER
		JOIN product_color pcolor ON
		pcommon.pid = pcolor.pid
		INNER JOIN brand
		brand ON brand.bno =
		pcommon.bno
		INNER JOIN pid_with_category_view v ON
		v.pid = pcommon.pid
		WHERE pcommon.pid IN

		<foreach collection='list' index='index' item='pidList'
			open='(' close=')' separator=','>
			#{pidList}
		</foreach>
	</select>
	
	<select id="getProductColor"
		resultType="com.hyundai.thehandsome.Vo.product.ColorVO">
		SELECT PID, PCID, PCIMG1, PCCHIPIMG, PCCOLORCODE
		FROM
		PRODUCT_COLOR
		WHERE PID = #{PID}
	</select>
	
	<select id="getProductDetail"
		resultType="com.hyundai.thehandsome.Vo.product.detail.ProductDetailVO">
		SELECT * FROM PRODUCT_DETAIL_VIEW
		WHERE PCID = #{PCID}
	</select>
	
	<select id="getProductImg" resultType="String">
		SELECT IMGSRC FROM
		PRODUCT_IMG
		WHERE PCID = #{PCID}
	</select>
</mapper>